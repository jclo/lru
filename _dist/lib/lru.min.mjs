/*! ****************************************************************************
 * LRU v1.0.2
 *
 * An in-memory key/value cache based on the Least Recently Used algorithm.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2020 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * Built from ES6lib v1.0.1.
 * ************************************************************************** */
const $__ES6GLOB={};!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?module.exports=t(e):e.LRU=t(e)}($__ES6GLOB,e=>{"use strict";let t,r,n;const i={Public:{}};return r=function(e,t){const r=Object.keys(t);for(let n=0;n<r.length;n++)e[r[n]]=t[r[n]]},n={isUndefined:e=>void 0===e,isNull:e=>null===e,isBoolean:e=>!0===e||!1===e||"[object Boolean]"===Object.prototype.toString.call(e),isString:e=>"[object String]"===Object.prototype.toString.call(e),isNumber:e=>"[object Number]"===Object.prototype.toString.call(e),isNaN(e){return this.isNumber(e)&&e!==+e},isOdd(e){const t=e%2;return e===parseFloat(e)?!!t:void 0}},function(){const e=i.Public;function t(e){for(;e.lru<e.mru&&void 0===e.list[e.lru];)e.lru+=1}function n(e,t){return new Date-e.cache[t].birth<=e.maxAge}function s(e,t){return{value:e.cache[t].value,age:new Date-e.cache[t].birth}}r(e,{set(e,r,n,i){let c;return e.cache[r]?(i&&!0===i.force&&(c=e.cache[r].stamp,e.cache[r]={value:n,stamp:e.mru,birth:new Date},e.list[e.cache[r].stamp]=r,delete e.list[c],e.mru+=1),s(e,r)):(e.cache[r]={value:n,stamp:e.mru,birth:new Date},e.list[e.cache[r].stamp]=r,e.mru+=1,e.items+=1,function(e){let r;for(;e.items>e.maxItems;)t(e),r=e.list[e.lru],delete e.cache[r],delete e.list[e.lru],e.items-=1,t(e)}(e),s(e,r))},get(e,t){let r;return e.cache[t]?n(e,t)?(r=s(e,t),e.cache[t].birth=new Date):(this.remove(e,t),r=null):r=null,r},has(e,t){return e.cache[t]&&n(e,t)?s(e,t):(this.remove(e,t),null)},remove(e,r){if(!e.cache[r])return null;const{stamp:n}=e.cache[r];return delete e.cache[r],delete e.list[n],e.items-=1,parseInt(n,10)===e.lru&&(e.lru=-1,t(e)),!0},empty(e){e.cache={},e.list={},e.lru=0,e.mru=0,e.items=0},dump(e){const t=Object.keys(e.list),r=[];for(let n=0;n<t.length;n++){const i=e.list[t[n]];r.push({key:i,value:e.cache[i].value,age:new Date-e.cache[i].birth})}return r},prune(e){const t={};let r;r=Object.keys(e.list);for(let t=0;t<r.length;t++){const i=e.list[r[t]];n(e,i)||this.remove(e,i)}r=Object.keys(e.list);for(let n=0;n<r.length;n++){const i=e.list[r[n]],s=n.toString();t[s]=i,e.cache[i].stamp=s}e.list=t},renew:(e,t)=>e.cache[t]?(e.cache[t].birth=new Date,s(e,t)):null})}(),function(){const r=i.Public,s=e.LRU;let c,u,l;function a(){l=!1,setTimeout(()=>{l=!0},u)}function o(e){u&&l&&(l=!1,a(),e.prune())}t=function(e){const t=Object.create(c);t._library={name:"LRU",version:"1.0.2"},t.db={};const{db:r}=t;return r.cache={},r.list={},r.lru=0,r.mru=0,r.items=0,r.maxItems=e&&n.isNumber(e.maxItems)&&e.maxItems>0?Math.ceil(e.maxItems):1e3,r.maxAge=e&&n.isNumber(e.maxAge)&&e.maxAge>=100?Math.ceil(e.maxAge):36e5,u=e&&n.isNumber(e.prune)&&e.prune>=1e3?Math.ceil(e.prune):null,u&&a(),t},t.NAME="LRU",t.VERSION="1.0.2",t._setTestMode=function(){return[n]},t.noConflict=function(){return e.LRU=s,this},c={whoami(){return this._library},set(e,t,i){return o(this),n.isString(e)?r.set(this.db,e,t,i):null},get(e){return o(this),n.isString(e)?r.get(this.db,e):null},has(e){return o(this),n.isString(e)?r.has(this.db,e):null},remove(e){return o(this),n.isString(e)?r.remove(this.db,e):null},empty(){return r.empty(this.db),this},dump(){return o(this),r.dump(this.db)},prune(){r.prune(this.db)},count(){return o(this),this.db.items},renew(e){return o(this),n.isString(e)?r.renew(this.db,e):null}}}(),t});export default $__ES6GLOB.LRU;