/*! ****************************************************************************
 * LRU v0.0.3
 *
 * An in-memory key/value cache based on the Least Recently Used algorithm.
 * (you can download it from npm or github repositories)
 * Copyright (c) 2020 Mobilabs <contact@mobilabs.fr> (http://www.mobilabs.fr).
 * Released under the MIT license. You may obtain a copy of the License
 * at: http://www.opensource.org/licenses/mit-license.php).
 * Built from ES6lib v0.0.10.
 * ************************************************************************** */
!function(e,t){"use strict";"function"==typeof define&&define.amd?define([""],t):"object"==typeof exports?(module.exports=t(e),null===e.LRU&&(e.LRU=t(e))):e.LRU=t(e)}(this,e=>{"use strict";let t,n,r;const i={Public:{}};return n=function(e,t){const n=Object.keys(t);for(let r=0;r<n.length;r++)e[n[r]]=t[n[r]]},r={isUndefined:e=>void 0===e,isNull:e=>null===e,isBoolean:e=>!0===e||!1===e||"[object Boolean]"===Object.prototype.toString.call(e),isString:e=>"[object String]"===Object.prototype.toString.call(e),isNumber:e=>"[object Number]"===Object.prototype.toString.call(e),isNaN(e){return this.isNumber(e)&&e!==+e},isOdd(e){const t=e%2;return e===parseFloat(e)?!!t:void 0}},function(){const e=i.Public;function t(e){for(;e.lru<e.mru&&void 0===e.list[e.lru];)e.lru+=1}function r(e,t){return new Date-e.cache[t].birth<=e.maxAge}function s(e,t){return{value:e.cache[t].value,age:new Date-e.cache[t].birth}}n(e,{set(e,n,r,i){let c;return e.cache[n]?(i&&!0===i.force&&(c=e.cache[n].stamp,e.cache[n]={value:r,stamp:e.mru,birth:new Date},e.list[e.cache[n].stamp]=n,delete e.list[c],e.mru+=1),s(e,n)):(e.cache[n]={value:r,stamp:e.mru,birth:new Date},e.list[e.cache[n].stamp]=n,e.mru+=1,e.items+=1,function(e){let n;for(;e.items>e.maxItems;)t(e),n=e.list[e.lru],delete e.cache[n],delete e.list[e.lru],e.items-=1,t(e)}(e),s(e,n))},get(e,t){let n;return e.cache[t]?r(e,t)?(n=s(e,t),e.cache[t].birth=new Date):(this.remove(e,t),n=null):n=null,n},has(e,t){return e.cache[t]&&r(e,t)?s(e,t):(this.remove(e,t),null)},remove(e,n){if(!e.cache[n])return null;const{stamp:r}=e.cache[n];return delete e.cache[n],delete e.list[r],e.items-=1,parseInt(r,10)===e.lru&&(e.lru=-1,t(e)),!0},empty(e){e.cache={},e.list={},e.lru=0,e.mru=0,e.items=0},dump(e){const t=Object.keys(e.list),n=[];for(let r=0;r<t.length;r++){const i=e.list[t[r]];n.push({key:i,value:e.cache[i].value,age:new Date-e.cache[i].birth})}return n},prune(e){const t={};let n;n=Object.keys(e.list);for(let t=0;t<n.length;t++){const i=e.list[n[t]];r(e,i)||this.remove(e,i)}n=Object.keys(e.list);for(let r=0;r<n.length;r++){const i=e.list[n[r]],s=r.toString();t[s]=i,e.cache[i].stamp=s}e.list=t},renew:(e,t)=>e.cache[t]?(e.cache[t].birth=new Date,s(e,t)):null})}(),function(){const n=i.Public,s=e.LRU;let c,l,u;function a(){u=!1,setTimeout(()=>{u=!0},l)}function o(e){l&&u&&(u=!1,a(),e.prune())}t=function(e){const t=Object.create(c);t.db={};const{db:n}=t;return n.cache={},n.list={},n.lru=0,n.mru=0,n.items=0,n.maxItems=e&&r.isNumber(e.maxItems)&&e.maxItems>0?Math.ceil(e.maxItems):1e3,n.maxAge=e&&r.isNumber(e.maxAge)&&e.maxAge>=100?Math.ceil(e.maxAge):36e5,l=e&&r.isNumber(e.prune)&&e.prune>=1e3?Math.ceil(e.prune):null,l&&a(),t},t.VERSION="0.0.3",t._=r,t.noConflict=function(){return e.LRU=s,this},c={set(e,t,i){return o(this),r.isString(e)?n.set(this.db,e,t,i):null},get(e){return o(this),r.isString(e)?n.get(this.db,e):null},has(e){return o(this),r.isString(e)?n.has(this.db,e):null},remove(e){return o(this),r.isString(e)?n.remove(this.db,e):null},empty(){return n.empty(this.db),this},dump(){return o(this),n.dump(this.db)},prune(){n.prune(this.db)},count(){return o(this),this.db.items},renew(e){return o(this),r.isString(e)?n.renew(this.db,e):null}}}(),t});